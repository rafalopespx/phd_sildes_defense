<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Dengue dynamics under climate drivers</title>
    <meta charset="utf-8" />
    <meta name="author" content="Rafael Lopes Paixão da Silva" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/shareon/shareon.min.css" rel="stylesheet" />
    <script src="libs/shareon/shareon.min.js"></script>
    <link href="libs/xaringanExtra-shareagain/shareagain.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-shareagain/shareagain.js"></script>
    <link href="libs/pagedtable/css/pagedtable.css" rel="stylesheet" />
    <script src="libs/pagedtable/js/pagedtable.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Dengue dynamics under climate drivers
]
.subtitle[
## Analysis with ecological and epidemiological frameworks
]
.author[
### Rafael Lopes Paixão da Silva
]
.institute[
### IFT, Unesp
]
.date[
### 31-10-2022
]

---

layout: true





---

class: left

## Find me at

.left-column[

<svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> GitHub: [https://github.com/rafalopespx/](https://github.com/rafalopespx/)

<svg aria-hidden="true" role="img" viewBox="0 0 576 512" style="height:1em;width:1.12em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M160 448c-25.6 0-51.2-22.4-64-32-64-44.8-83.2-60.8-96-70.4V480c0 17.67 14.33 32 32 32h256c17.67 0 32-14.33 32-32V345.6c-12.8 9.6-32 25.6-96 70.4-12.8 9.6-38.4 32-64 32zm128-192H32c-17.67 0-32 14.33-32 32v16c25.6 19.2 22.4 19.2 115.2 86.4 9.6 6.4 28.8 25.6 44.8 25.6s35.2-19.2 44.8-22.4c92.8-67.2 89.6-67.2 115.2-86.4V288c0-17.67-14.33-32-32-32zm256-96H224c-17.67 0-32 14.33-32 32v32h96c33.21 0 60.59 25.42 63.71 57.82l.29-.22V416h192c17.67 0 32-14.33 32-32V192c0-17.67-14.33-32-32-32zm-32 128h-64v-64h64v64zm-352-96c0-35.29 28.71-64 64-64h224V32c0-17.67-14.33-32-32-32H96C78.33 0 64 14.33 64 32v192h96v-32z"/></svg> e-Mail: [lopes1313@gmail.com](mailto:lopes1313@gmail.com)

<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> Twitter: [@rafalpx](www.twitter.com/rafalpx)

]

.pull-right[

![profile](img/profile_pick.jpeg)

]

---

## About me

+ Ph.D. Candidate in Physics, in the Instituto de Física Teórica - IFT/ UNESP-SP

+ Bachelor in Physics by UNICAMP (2014), Master in Physics by IFT/UNES-SP (2018)

+ With a exchange period (2021-2022), in the Barcelona Institute for Global Health (ISGlobal), at Barcelona.

---

## Summary

This presentation is divided into 4 main parts:

+ Historical background on Dengue

+ Ecological analysis of Dengue data and climate data

+ Epidemiological analysis of Dengue data and temperature data

+ Final remarks

---

## Research questions

The thesis has two main questions that tries to answer:

* In the Ecological part: **How temperature and precipitation affects the variability of Dengue cases in a major city of Brazil?** The study covers 10 years (2010 - 2019) of Dengue incidence

* In the Epidemiological part: **How temperature is associated with higher levels of Dengue hospitalizations in Brazil?**
The study covers 10 years (2010 - 2019) of Dengue hospitalization incidence

---

class: middle, center, inverse

# Historical Background

---

## Historical Background

Dengue has been a major problem on Brazil during the 20th Century:

- First records of Dengue in Brazil starts on the last decades of the 19th century

- The main vector of Dengue, _Aedes Aegypti_ got locally eliminated, but was reintroduced in the 1970s

- Since then, Dengue has continuously rising in incidence and dispersion over the Brazillian territory

- Since 2001, a system of notification dedicated and surveillance specific to the disease was build

---

## Dengue Disease

.pull-left[

  vector borne disease, human-mosquito-human cycle

  incubation period of four- to six-day and persists until around the time fever abates, 
which is typically three to seven days, potential of cryptic transmissions

  Hyperendemic disease in Brazil, with anual cycles of outbreaks

]

.pull-right[

&lt;img src="img/Aedes_aegypti.jpg" width="2400" /&gt;

]

---

## Data sources:


.pull-left[

__Epidemiological data sources__

  - From the _Sistema de Informação de Agravos de Notificação_ (SINAN), system more prompt to notify symptomatic mild cases of Dengue

  - From the _Sistema de Informação Hospitalares_ (SIH), system more prompt to notify severe cases of Dengue


]

.pull-right[

__Climate data sources__

  - For the climate variable, we used the gridded daily ECVs taken from reanalysis products (ERA5-Land) 

  - From the raw ECVs were produced a weighted mean area aggregation over the municipalities (health regions, states, etc.) 
  extent area, to create matching time series for each aggregation level.


]


---

## Characteristics of Dataset

- ~11.0 million of individual cases confirmed for Dengue, with information of Sex, Age, Municipality of Residence, from 2001 to 2020

- Sparse data before 2000, due to non obligatory notification, more consistent data after 2001

- With the majority of cases in the Southeast region and Northeast regions, ~5.7 millions and ~2.2 million cases, respectively

---

## Characteristics of Dengue epidemics

- Strong seasonality, right after the rainy season, relation with mosquito life cycle

- Hyperendemicity, endemic epidemics outbreaks of four different serotypes

- More recently, since 2020, raising on incidence and spread to the South region

---

&lt;img src="img/dengue_cases_regions_after_2001.png" width="800" style="display: block; margin: auto;" /&gt;

---

class: middle, center, inverse

# Ecological analysis

---

## Objectives and Questions

**How Temperatures &amp; Total Preciptations affects the counts of Cases due to Dengue in Brazil, during 2010-2019?**

Objectives: 

-1) To quantify climate drivers by *EDM* of temperature and precipitation on counts of cases due to Dengue

-2) Understand which are the climatic drivers and how much they force on cases

---

## Empirical Dynamic Modelling

Framework to analyse time series seeking for causality between them:

- From the Takens Theorem we can reconstruct any dynamical system by any observation and its delays

---

&lt;img src="img/Takens Theorem.png" width="800" style="display: block; margin: auto;" /&gt;

---

## Empirical Dynamic Modelling

Framework to analyse time series seeking for causality between them:

- From the Takens Theorem we can reconstruct any dynamical system by any observation and its delays

- This reconstruction it is called __Shadow-Manifold__, it maps complete the dynamics into the original Manifold

---

&lt;img src="img/State Space Reconstruction.png" width="800" style="display: block; margin: auto;" /&gt;

---

## Empirical Dynamic Modelling

Framework to analyse time series seeking for causality between them:

- From the Takens Theorem we can reconstruct any dynamical system by any observation and its delays

- This reconstruction it is called __Shadow-Manifold__, it maps complete the dynamics into the original Manifold

- Any two __Shadow-Manifolds__ that maps each other are __Causal__ linked

---

&lt;img src="img/Causality.png" width="800" style="display: block; margin: auto;" /&gt;

---

## Dengue in Rio de Janeiro city

Typical procedure of *EDM*

1) Extract the seasonality of the drivers, make a distribution of surrogate time series.

2) Do the CCM with the Original time-series and 500 Surrogates series with the same seasonality pattern

3) Repeat for different values of time for predicition `\(tp\)`

4) Where in the `\(tp\)` the Original is above the 0.95th percentile of the `\(\rho_{CCM}\)` distribution for the 500 Surrogates time-series, it is significant causal relation

5) Estimate the force of causality for the drivers at the time for prediction with highest `\(\rho_{CCM}\)` by applying S-Map

---

&lt;img src="img/cases_rj.png" width="800" style="display: block; margin: auto;" /&gt;

---

## Extracting seasonality &amp; Surrogate making

The algorithm we use is:

- Fit a cubic smooth spline to each climate driver, this gives a seasonal component to each driver

- substract this seasonality pattern from the original driver time series

- The residuals are shuffled yearly and after is added the seasonality pattern

- This new surrogate time series for the climate driver, has the same seasonal pattern but different residuals

- Make 500 of this surrogates series

---

&lt;img src="img/patch_pattern_seasonality.png" width="700" style="display: block; margin: auto;" /&gt;

---

## Surrogate statistical test

To create each surrogate time series, we pick the seasonality pattern and add a sample of residuals randomly shuffled:

- This creates a surrogate time series for the driver, with the same seasonal pattern but different values

- When putting this on the CCM function, we ask if the seasonal pattern is driving the dynamics, if yes, the surrogates will have a better prediction skill then the original time series

- The dynamics will them linked to the seasonality of the driver and not to the climate driver itself

---

&lt;img src="img/patch_final_surrogates.png" width="700" style="display: block; margin: auto;" /&gt;

---

## Surrogates testing

Now we want to find where in the time for prediction, `\(tp\)`, the original driver is most significant causal:

- We apply CCM on the 500 surrogates and the Original time series for various `\(tp\)` values, of maximum 17 weeks of delay

- Where the Original driver time series is above the 95th percentile of the distribution it causally significant

---

&lt;img src="img/yearly_shuffle_boxplot_17_weeks_tp_type.png" width="700" style="display: block; margin: auto;" /&gt;

---

## Surrogates testing

- Where the original driver has a value of cross-mapping skill higher the 95th percentile of the distribution we color it in red

- We repeat this procedure of identifiying where the original driver is stastistically significant through over all the `\(tp\)` values tested
---

&lt;img src="img/yearly_shuffle_boxplot_drivers_tp_sig_17_weeks.png" width="700" style="display: block; margin: auto;" /&gt;

---

## Force of Interaction

With the climate driver and the time for prediction where the original driver is causal significant and where it is has the greater `\(\rho\)` we estimate the force of interaction:

- Using the S-Map algorithm, we estimate the effect of the driver, at the `\(tp\)`, on the time series of Cases

- S-Map is a non-parametric method of locally weighted Jacobian Element for the prediction of the cases time-series from the climate drivers SSR

---

## Force of Interaction

The S-Map has the following formula, which it is a Singular Value Decomposition (SVD) algorithm:

$$
`\begin{equation}
Cases(t) = \mathbf{C_0} + \sum_{i=1}^{I} \mathbf{C_i}(t) x_i(t),
\end{equation}`
$$

Where `\(I\)` is until the drivers we found as significant causal on the Cases time series. We choose the minimum value of Mean Absolute Error (MAE), between predictions and observations given by the S-Map for `\(\theta\)`. Where `\(C_i\)` are weights to pounder how great are the influences of each nearby point on the predicted point.

---

## Theta form

`\(\theta\)` it is the locally weighted kernel to the decay of influence of each point considered into the prediction, with the formula: 

`$$C_i = \exp^{-\theta\frac{\|x(t_k) - x(t)\|}{d}}$$`

If `\(\theta\)` is `\(0\)` or close to `\(0\)` the model understand the influence of each driver as linear, as `\(\theta\)` grows the model gives more non-linearity weight to each of the drivers.

---

&lt;img src="img/yearly_shuffle_tp_17_theta_min_mae_rmse.png" width="700" style="display: block; margin: auto;" /&gt;

---

## S-Map Models

We then employ the following model to the force of interaction estimation:

$$
`\begin{multline}
Cases(t) = \mathbf{C_0} + \frac{\partial Cases(t)}{\partial Precip_{max}(t-2)}Precip_{max}(t-2)+ \\
\frac{\partial Cases(t)}{\partial Precip_{min}(t-7)}Precip_{min}(t-7)
\end{multline}`
$$

Where `\(C_0\)` is a constant term and the folliwng terms are the coeffcients to be estimated locally over the SSR constructed with the time-series `\(Cases(t),Precip_{min}(t-7), Precip_{max}(t-2)\)`

---

&lt;img src="img/patchwork_coef_precip_tp_17.png" width="750" style="display: block; margin: auto;" /&gt;

---

## Conclusion &amp; Interpretation

* __Temperatures__ are climate drivers of Cases at Rio de Janeiro city, but them drives cases in the city by its seasonality and not by its variability, due to not being found as drivers by CCM. So they are a conditions that is matched by a season on year.

* __Maximum Precipitation__ has an lagged effect on cases of 2 weeks, and it decreases with the rising of maximum amount precipitation, we understand it as being a driver that has a saturation effect on the forcing, flushing effects on mosquito life cycle.

* __Minimum Precipation__ has a lagged effect on cases of 7 week, in the same shape as Max. Preciptation, after drought any amount of precipitation helps the mosquito cycle. 

* Precipitations drives the cases by variability at the right conditions.

---

class: middle, center, inverse

# Epidemiological analysis

---

## Objectives and Questions

**How ambient temperature affects the counts of hospitalization due to Dengue, during the period of 2010-2019?**

Objectives: 

- To quantify association of daily ambient temperature and counts of hospitalization due to Dengue

---

## Data sources and definitions:

- We used the Brazil national database of authorization for hospitalization (AIH), filtered for the ICD-10 codes, ’A90’, ’A91’, ’A97’, ’A970’, ’A971’, ’A972’, ’A979’, for the hospitalization cases of Dengue, aggregated by municipality.

- For the climate variables, we used the gridded daily temperature taken from reanalysis products (ERA5Land) 

- We have done a weighted mean area aggregation over the municipality extent area, to create matching time series for each municipality.

---

## Study Design

We did a two-stages design, to the association of the daily mean temperature and counts of hospitalization due Dengue.

+ First stage: A "Time Stratified" design for the aggregated level of a each of 27 states, with a stratum for each municipality within a state, day of the week and the month on the time series.

+ Second stage: Multivariate Meta-analysis for the coefficients fitted and the Covariance matrix, in two levels of aggregation, for the whole country and for the 5 macro regions of Brazil. 

  - The model on this level was a multivariate random effects model ran by a restricted maximum likelihood estimator.


---

## Model specification, first stage

&lt;!-- Before desribing the model itself, we settle down some concepts on statistical models used. When describing a model we construct it from the likelihood we suppose it gives the distribution of the data.  --&gt;
In this study we suppose the Dengue hospitalization counts in the city `\(i\)` at time `\(t\)` is given by a `\(Poisson(\lambda_{i,t})\)` distribution, with the conditional that `\(Y_{.,t} = \sum_i Y_{i,t}\)`, for overdispersed data it used as a `\(quasiPoisson\)` distribution to account for overdispersed data:

$$
`\begin{equation}
Y_{i,t} \sim quasiPoisson(\lambda_{i,t},\psi)
\end{equation}`
$$

Where the `\(\lambda_{i,t}\)` and `\(\psi\)` is the parameter to control overdispersion, and we choose a log function for the link-function

---

## Model specification, first stage

On each of 27 states, we run a Conditional Poisson model, for the association between Dengue hospitalizations time series and mean temperature for each municipality:

`$$log[\lambda_{i,t}] = \xi_{t,i} + f(x_{t,i},l) + \sum_{k=1}^{K}s_k(t)$$`

Where `\(Y_{t,i}\)` is as before the count of cases at `\(t\)` on the i-th municipality, `\(\xi_{t,i}\)` the dow-month-city strata term conditioned out. `\(f(x_{t,i}, l)\)` which is the __DLNM__ for mean temperature on the state by each day of delay, until 21 days of lags. The last term is the long-term trend for temperature trend along the whole period, a natural spline with 7 degrees of freedom by year on the whole period.

---

## Crossbasis Parametrization

The *cross-basis* were parametrized as the standard in __DLNM__ for mean temperature: 

+ A *natural splines* with 2 knots equally spaced on the range of mean temperature,
for the structure to the doses-response

+ A *natural spline* with 3 knots equally spaced on the log-scale for the lag-response structure

+ 0 to 21 days of lags

---

## Geographical Variation

Why we make use of such models? Because enviromental exposures has two main features that needs atention to be drawned:

+ Normally, exposures varies in a narrow range, environmental exposures like temperature __not__, it varies along different locations.

+ Normally, exposures have a very short time-window of action, environment exposures __not__, it can acts all the time for the all the subjects.

---

&lt;img src="img/geo_temp_inset.png" width="800" style="display: block; margin: auto;" /&gt;

---

## Second Stage

For the second stage we choose a multivariate meta-analysis model, on each meta-analysis level, whole country or by macro region, with the following formulation:

$$
`\begin{equation}
\hat{\theta_i} | u_i \sim N_k (\theta + u_i , S_i ), \\
u_i ∼ N_k (0, \psi)
\end{equation}`
$$

Where, `\(\hat{\theta_i}\)` vector `\(k\times1\)` combined effects to the estimate, 
`\(u_i\)` vector `\(k \times 1\)` random effects for the coefficients of study `\(i\)`.
`\(S_i\)` matrix `\(k \times k\)` covariance matrix within studies for the study `\(i\)` and `\(\psi\)` matrix `\(k \times k\)` covariance between studies, defined by `\(k(k + 1)/2\)` variables `\(\xi\)`.

---

class: middle, center

# Second Stage Results, Whole Country Meta-analysis

---

&lt;img src="img/figure_1_meta_analysis.png" width="800" style="display: block; margin: auto;" /&gt;

---

class: middle, center

# Second Stage Results, Regions Meta-analysis

---

&lt;img src="img/plot_overall_regions_all_regions_gnm_meta.png" width="800" style="display: block; margin: auto;" /&gt;

---

## Table Summary

&lt;div data-pagedtable="false"&gt;
  &lt;script data-pagedtable-source type="application/json"&gt;
{"columns":[{"label":["State"],"name":[1],"type":["chr"],"align":["left"]},{"label":["MHT"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["RR 5th (IC 95%)"],"name":[3],"type":["chr"],"align":["left"]},{"label":["RR 95th (IC 95%)"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"Brazil","2":"10.8","3":"1.404 (1.274-1.548)","4":"1.491 (1.337-1.664)"},{"1":"North","2":"22.8","3":"1.153 (1.026-1.295)","4":"1.256 (1.039-1.518)"},{"1":"Northeast","2":"19.7","3":"1.196 (1.091-1.312)","4":"1.255 (1.059-1.488)"},{"1":"Center-West","2":"17.0","3":"1.303 (1.093-1.553)","4":"1.460 (1.198-1.779)"},{"1":"Southeast","2":"13.7","3":"1.353 (1.171-1.563)","4":"1.498 (1.298-1.729)"},{"1":"South","2":"7.4","3":"2.723 (1.447-5.125)","4":"2.508 (1.362-4.618)"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  &lt;/script&gt;
&lt;/div&gt;

---

## Conclusion &amp; Interpretation

* The main finding is that are higher risk of being hospitalised by Dengue as the temperature gets higher.
* After 20 degrees Celsius, the risk is 1·2x higher than for the minimum temperature of hospitalisation (10·8 º C)

* We found a stronger immediate effect on the RR to the hospitalisation. 

* We found the same patterns over each macro region of Brazil for the general association between RR hospitalisation and ambient temperature. 

---

class: middle, center, inverse

# Final Remarks and Next steps


---

## Summary, Ecological part

On this part we had studied the dynamics of mild to severe cases of Dengue in Brazil, during the a period of 10 years, from 2010 to 2019.

- we investigated how temperature and precipitation drives the dynamics of cases in a major city that has a historical of endemicity od Dengue, for the cited period.

* Main finding is that precipitation is a driver of the dynamics of cases through the variability of the time-series, and it has a lagged relation for this forcing, being 2 weeks lagged for the maximum precipitation and 7 weeks for the minimum precipitation

* Secondary finding, is that temperature has a role on the dynamics of dengue cases through seasonality

---


## Summary, Epidemiological part

On this part we had studied the dynamics of severe hospitalized cases of Dengue in Brazil, during the a period of 10 years, from 2010 to 2019.

- we investigated how temperature is associated with dengue hospitalizations in the whole country at the level of municipality, and how this can give an augmented risk to hospitalizations.

* Main finding is that temperature above 20 degrees Celsius is consistently associated with higher levels of hospistalisations, over the whole country and the for each of the macro-regions.

* Secondary finding, is that temperature has lagged effects when producing augmented risks to the hospistalisations.

---

class: middle, center

# Other publications

---

## Published Articles

  * **Model-based estimation of transmissibility and reinfection of SARS-CoV-2 P. 1 variant**
  Coutinho, R.M., Marquitti, F.M.D., Ferreira, L.S., Borges, M.E., __da Silva, R.L.P.__, Canton, O., Portella, T.P., Poloni, S., Franco, C., Plucinski, M.M. and Lessa, F.C., 2021.
  [https://www.nature.com/articles/s43856-021-00048-6](https://www.nature.com/articles/s43856-021-00048-6) 
  Communications Medicine, 1(1), pp.1-8.

  * **Brazil in the face of new SARS-CoV-2 variants: emergencies and challenges in public health**. 
  Marquitti, F.M.D., Coutinho, R.M., Ferreira, L.S., Borges, M.E., Portella, T.P., __Silva, R.L.P.__, Canton, O., Poloni, S., Franco, C., Coelho, V. and Barberia, L., 2021.
  [https://www.scielo.br/j/rbepid/a/fMnYkyJKLhpwj8fF8dkbgKQ/?lang=en](https://www.scielo.br/j/rbepid/a/fMnYkyJKLhpwj8fF8dkbgKQ/?lang=en) 
  Revista Brasileira de Epidemiologia, 24.
  
  
---

## Published Articles

  * **Assessing the best time interval between doses in a two-dose vaccination regimen to reduce the number of deaths in an ongoing epidemic of SARS-CoV-2** 
  Souto Ferreira, L., Canton, O., __da Silva, R.L.P.__, Poloni, S., Sudbrack, V., Borges, M.E., Franco, C., Marquitti, F.M.D., de Moraes, J.C., Veras, M.A.D.S.M. and Kraenkel, R.A., 2022.
  [https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1009978](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1009978)
  PLoS computational biology, 18(3), p.e1009978.

---

## Submitted Articles

  * **Ambient Temperature and Dengue Hospitalisation in Brazil over a 10-year period, 2010-2019: a times series analysis** 
  __da Silva, R.L.P__, Basagana, X., Bastos, L.S., Bozza, F.A. and Ranzani, O.T., 2022.
  [https://www.medrxiv.org/content/medrxiv/early/2022/04/15/2022.04.05.22273394.full.pdf](https://www.medrxiv.org/content/medrxiv/early/2022/04/15/2022.04.05.22273394.full.pdf)
  medRxiv. (Under Review in The Lancet Regional Americas)

  * **Estimating the impact of implementation and timing of COVID-19 vaccination program in Brazil: a counterfactual analysis**
  Ferreira, L.S., Marquitti, F.M.D., __da Silva, R.L.P__, Borges, M.E., Gomes, M.F., Cruz, O.G., Kraenkel, R.A., Coutinho, R.M., Prado, P.I. and Bastos, L.S., 2021. 
  [https://www.medrxiv.org/content/medrxiv/early/2021/12/27/2021.12.24.21268384.full.pdf](https://www.medrxiv.org/content/medrxiv/early/2021/12/27/2021.12.24.21268384.full.pdf)
   medRxiv.

---

## Software published

.pull-left[

During the covid-19 pandemic, together with Leaonardo Bastos, we build a wrapping R package **Nowcaster** to produce at necessity age-dependent nowcastings, to correct the notification delay of cases, the package website is: [https://www.covid19br.github.io/nowcaster](https://www.covid19br.githubu.io/nowcaster)

]

.pull-right[

# &lt;a href='https://github.com/covid19br/nowcaster'&gt;&lt;img src='img/nowcaster.png' align="right" width="240" /&gt;&lt;/a&gt; &lt;a href='https://github.com/covid19br/nowcaster'&gt;&lt;img src='img/nowcaster_rev.png' align="right" width="240" /&gt;&lt;/a&gt;

]

---

class: middle, center

# Thank You!
# ¡Gracias!
# Obrigado!

<svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> GitHub: [https://github.com/rafalopespx/](https://github.com/rafalopespx/)
<svg aria-hidden="true" role="img" viewBox="0 0 576 512" style="height:1em;width:1.12em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M160 448c-25.6 0-51.2-22.4-64-32-64-44.8-83.2-60.8-96-70.4V480c0 17.67 14.33 32 32 32h256c17.67 0 32-14.33 32-32V345.6c-12.8 9.6-32 25.6-96 70.4-12.8 9.6-38.4 32-64 32zm128-192H32c-17.67 0-32 14.33-32 32v16c25.6 19.2 22.4 19.2 115.2 86.4 9.6 6.4 28.8 25.6 44.8 25.6s35.2-19.2 44.8-22.4c92.8-67.2 89.6-67.2 115.2-86.4V288c0-17.67-14.33-32-32-32zm256-96H224c-17.67 0-32 14.33-32 32v32h96c33.21 0 60.59 25.42 63.71 57.82l.29-.22V416h192c17.67 0 32-14.33 32-32V192c0-17.67-14.33-32-32-32zm-32 128h-64v-64h64v64zm-352-96c0-35.29 28.71-64 64-64h224V32c0-17.67-14.33-32-32-32H96C78.33 0 64 14.33 64 32v192h96v-32z"/></svg>  [lopes1313@gmail.com](mailto:lopes1313@gmail.com)
<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> Twitter: [@rafalpx](www.twitter.com/rafalpx)

---

class: middle, center, inverse

# Appendices

---

## Takens Theorem

The importance of Takens theorem, in view of applications, is that we can reconstruct an
attractor solely from one of its variables time-series. It means that we can use `\(X_1\)` to obtain the attractor of the system that generated the time-series `\(X_1\)`, without any knowledge of the underlying equations. The reconstruction is built considering an m-dimensional space with time-lagged coordinates:

`$$\{X_1 (t), X_1 (t + \tau ), X_1 (t + 2\tau ), ...X_1 (t + (m − 1)\tau \}$$`

By considering the time-series `\(X_1 (t)\)` for all t, we will have a sub-manifold of the m-dimensional space. This sub-manifold has a one-to-one correspondence with the original attractor of the system. Takens theorem
guarantees that the dimension m is, at most, `\(2n + 1\)`.

---

## Simplex Projection, I

The simplex projection is basically a method
to follow `\(n\)` time steps ahead each of the simplex points encapsulating a single point, the
predictee point, `\(\hat{X}(t+n)\)`.

$$
`\begin{equation}
\hat{X}(t+n) = \sum_{i=1}^{E+1}w_iX_i(t+n)
\end{equation}`
$$
When varying how many delays we put into the embedding dimension of reconstructed state-space, we can choose the optimal embedding
dimension for the system.

---

## Simplex Projection, II

After realising this projection for the whole time series, i.e., using all the points we compare the observed time series and the predictied one, from this we can given an good estimate on how good is the projection we are building:

$$
`\begin{equation}
\rho_{O,P} = \frac{Cov[O,P]}{\sigma_O \sigma_P}
\end{equation}`
$$

The embeddign dimensions will be the dimension for which this correlation reaches its maximum, this means the dimension is sufficient to reconstruct completely the original dynamics


---

## Model building, First stage

In this study we suppose the Dengue hospitalization counts in the city `\(i\)` at time `\(t\)` is given by a `\(Poisson(\lambda_{i,t})\)` distribution, with the conditional that `\(Y_{.,t} = \sum_i Y_{i,t}\)`, this actually is a `\(Multinomial\)` model, which we use an alternative formulation of an `\(quasiPoisson\)` distribution to account for overdispersed data:

$$
`\begin{equation}
Y_{i,t}|Y_{.,i} \sim Multinomial(\pi_{i,t}) \equiv quasiPoisson(\lambda_{i,t},\psi)
\end{equation}`
$$

Where `\(\pi_{i,t}\)` is given by the relation `\(\pi_{i,t} = \frac{\exp(\boldsymbol{\beta^T\boldsymbol{x_i}})}{\sum_{j\in t}\exp{\boldsymbol{\beta^{T}\boldsymbol{x_j}}}}\)` and equivalently for the `\(\lambda_{i,t}\)`, and we choose a log link-function

---

## Cross-basis, I

Cross-basis is an advance on the enviromental epidemiology, cause it permits to construct a non-linear covariate that encompasses delays when studiying associationn between environmental factors and epidemiological outocomes of interest. To do so, we start construct a naive model, the Distributed Linear Model, __DLM__. A first __DLM__ is:

$$
`\begin{equation}
\log[E[Y_t]] = \alpha + \beta_0x_t + \beta_1x_{t-1} + \dots + \beta_jx_{t-j} + Covariates \dotsc, 
\end{equation}`
$$
This model has the pathologically case of introducing vartiables that will produce over and underestimates to the association, but it was a first attempt to model dealyed relation in epidemiology.

---

## Cross-basis, II

A way to overcome this is by using splines to smooth this covariates introduced: 

$$
`\begin{equation}
log(\mu_t) = \alpha + \sum_{j=1}^{J}s_j(x_{tj}; \boldsymbol{\beta}_j) + Covariates
\end{equation}`
$$

Where `\(s_j(x_{tj}; \boldsymbol{\beta}_j)\)` is the smoothing function, which can be reshaped to be turned into a more flexible form that can encompasses non-linear forms to the model.


---

## Cross-basis, III

The way to do this is by producing a _Basis-function_ that will expand eahc of the dimension, lag-response and dose-response into a smoothed version. This guarantees no over and/or understimation during the model processing.

$$
`\begin{equation}
log(\mu_t) = \alpha + \sum_{j=1}^{J}\mathbf{w}_{t,j}^T\boldsymbol{\eta} + Covariates
\end{equation}`
$$

Where `\(s(x_t;\boldsymbol{\eta}) = \mathbf{q}_t^T \cdot \mathbf{C} \boldsymbol{\eta} = \mathbf{w}_t^T\boldsymbol{\eta}\)`, is the _basis-function_ expanding the covariate into a its lags with a smoothing form for it.

---

## Cross-basis, IV

To construct a flexible and non-linear version of _DLM_ basically is to expand the `\(s(x_t; \boldsymbol{\eta})\)`, at same time on the dimension of lags and dose, this will produce the a covariate that can be seen as a surface:

$$
`\begin{equation}
s(x_t ; \boldsymbol{\eta}) = \sum_{j=1}^{v_x}\sum_{k=1}^{v_l}\mathbf{r}^T_{t j} \mathbf{c}_{k } \eta_{jk} = \mathbf{w}^T_{t} \boldsymbol{\eta}
\end{equation}`
$$

Where the `\(s(x_t; \boldsymbol{\eta})\)` is called __cross-basis__, this is a resulta of a Haddamard product of two Kroenecker products, given by: `\(\mathbf{A}_{t} = (\mathbf{1}_{v_l}^T \otimes \mathbf{R}_t) \odot (\mathbf{C} \otimes \mathbf{1}_{v_x}^T),\)`

---

## Model building, Second stage

As before, in the second stage we build a meta-analysis multivariate model to estimate, by different aggergations setting, the overall RR for Dengue hospitalization. To do so, we start imposing that for each `\(\hat{\theta_{i}}\)` study estimates we model its variance and covariance relation, with:

$$
`\begin{equation}
\hat{\theta_i} | u_i \sim N_k (\theta + u_i, S_i ), \\
u_i ∼ N_k (\theta, \psi)
\end{equation}`
$$

Where, `\(\hat{\theta_i}\)` vector `\(k\times1\)` combined effects to the estimate, 
`\(u_i\)` vector `\(k \times 1\)` random effects for the coefficients of study `\(i\)`.
`\(S_i\)` matrix `\(k \times k\)` covariance matrix within studies for the study `\(i\)` and `\(\psi\)` matrix `\(k \times k\)` covariance between studies, defined by `\(k(k + 1)/2\)` variables `\(\xi\)`.

----
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
  .logo {
    background-image: url(logo-IFT.png);
    background-size: contain;
    background-repeat: no-repeat;
    position: absolute;
    top: .1em;
    right: .1em;
    width: 110px;
    height: 128px;
    z-index: 0;
  }
</style>
  
  <script>
  document
.querySelectorAll(
  '.remark-slide-content' +
    ':not(.title-slide)' +
    // add additional classes to exclude here, e.g.
  // ':not(.inverse)' +
    ':not(.hide-logo)'
)
.forEach(el => {
  el.innerHTML += '<div class="logo"></div>';
});
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
